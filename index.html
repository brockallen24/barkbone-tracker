// ============================================
// ORDER PERSISTENCE
// ============================================

function saveProductOrder() {
    const order = products.map(p => p.id);
    localStorage.setItem('productOrder', JSON.stringify(order));
}

function loadProductOrder() {
    const savedOrder = localStorage.getItem('productOrder');
    return savedOrder ? JSON.parse(savedOrder) : null;
}

function applyProductOrder() {
    const savedOrder = loadProductOrder();
    if (!savedOrder || savedOrder.length === 0) {
        return; // No saved order, keep current order
    }

    // Create a map for quick lookup
    const orderMap = new Map();
    savedOrder.forEach((id, index) => {
        orderMap.set(id, index);
    });

    // Sort products based on saved order
    // Items not in saved order go to the end
    products.sort((a, b) => {
        const orderA = orderMap.has(a.id) ? orderMap.get(a.id) : Infinity;
        const orderB = orderMap.has(b.id) ? orderMap.get(b.id) : Infinity;
        return orderA - orderB;
    });
}
